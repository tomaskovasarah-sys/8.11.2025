<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>SledovÃ¡nÃ­ jezdcÅ¯</title>
  <style>
    body { font-family: Arial; text-align: center; margin-top: 30px; background: #fafafa; }
    select, button { font-size: 18px; margin: 10px; padding: 8px; border-radius: 8px; }
    button { background-color: #3b82f6; color: white; border: none; }
    button:disabled { background-color: #999; }
  </style>
</head>
<body>
  <h2>SledovÃ¡nÃ­ prÅ¯jezdu jezdcÅ¯ ğŸ</h2>

  <label>Skupina:</label><br>
  <select id="group">
    <option value="intelektualky">IntelektuÃ¡lky</option>
    <option value="pubertacky">PuberÅ¥aÄky</option>
    <option value="zelvy">Å½elvy</option>
    <option value="sneci">Å neci</option>
  </select><br>

  <label>Jezdec:</label><br>
  <select id="rider">
    <option value="MarkÃ©ta - Arista">MarkÃ©ta - Arista</option>
    <option value="Lucka - Tess">Lucka - Tess</option>
    <option value="Linda - HaniÄka">Linda - HaniÄka</option>
    <option value="KlÃ¡rka - Merlin">KlÃ¡rka - Merlin</option>
    <option value="KÃ¡ja - Marek">KÃ¡ja - Marek</option>
    <option value="VerÄa - DÃ©monka">VerÄa - DÃ©monka</option>
    <option value="AneÅ¾ka - Leon">AneÅ¾ka - Leon</option>
    <option value="AniÄka - Dasperr">AniÄka - Dasperr</option>
    <option value="SÃ¡ra - Hafling">SÃ¡ra - Hafling</option>
    <option value="RenÄa - Atena">RenÄa - Atena</option>
    <option value="RenÄa - Kip">RenÄa - Kip</option>
    <option value="MÃ­Å¡a - Rival">MÃ­Å¡a - Rival</option>
    <option value="AneÅ¾ka - Manilac">AneÅ¾ka - Manilac</option>
    <option value="Daja - Etna">Daja - Etna</option>
  </select><br><br>

  <button id="startBtn">START</button>
  <button id="stopBtn" disabled>STOP</button>

  <p id="status">ÄŒekÃ¡m na spuÅ¡tÄ›nÃ­...</p>

  <script>
    const url = "https://script.google.com/macros/s/AKfycbxr9hbf9pjYXXG6CO_EhCCf-0M3gbUn9J2pB46XFM8UlBmNsZ9cU_-d7vdtV2FHwh0BVQ/exec"

    let watchID = null;

    document.getElementById("startBtn").addEventListener("click", () => {
      const group = document.getElementById("group").value;
      const rider = document.getElementById("rider").value;

      document.getElementById("startBtn").disabled = true;
      document.getElementById("stopBtn").disabled = false;
      document.getElementById("status").innerText = "Sleduji polohu...";

      if (!navigator.geolocation) {
        alert("Geolokace nenÃ­ podporovÃ¡na!");
        return;
      }

      watchID = navigator.geolocation.watchPosition(pos => {
        const data = {
          lat: pos.coords.latitude,
          lon: pos.coords.longitude,
          group,
          rider
        };

        fetch(url, {
          method: "POST",
          body: JSON.stringify(data),
          headers: { "Content-Type": "application/json" }
        }).then(() => {
          document.getElementById("status").innerText =
            `ğŸ“ OdeslÃ¡no: ${group} - ${rider} (${data.lat.toFixed(5)}, ${data.lon.toFixed(5)})`;
        }).catch(() => {
          document.getElementById("status").innerText = "âŒ Chyba pÅ™i odesÃ­lÃ¡nÃ­!";
        });
      },
      err => alert("Chyba GPS: " + err.message),
      { enableHighAccuracy: true });
    });

    document.getElementById("stopBtn").addEventListener("click", () => {
      if (watchID) {
        navigator.geolocation.clearWatch(watchID);
        watchID = null;
        document.getElementById("startBtn").disabled = false;
        document.getElementById("stopBtn").disabled = true;
        document.getElementById("status").innerText = "SledovÃ¡nÃ­ zastaveno.";
      }
    });
  </script>
</body>
</html>